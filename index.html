<!DOCTYPE html>
<html lang="es">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-M2TH2RK1XH"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-M2TH2RK1XH');
    </script>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CodeCraft - Aventura Inform√°tica 1¬∞ A√±o</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Minecraft-inspired palette */
            --grass: #7CB342;
            --dirt: #8D6E63;
            --stone: #78909C;
            --diamond: #00E5FF;
            --emerald: #00E676;
            --gold: #FFD600;
            --redstone: #D32F2F;
            --lapis: #1976D2;
            --iron: #90A4AE;
            --coal: #212121;
            --wood: #A1887F;
            --obsidian: #1A237E;
            
            --bg-dark: #1a1a2e;
            --bg-medium: #16213e;
            --bg-light: #0f3460;
            --text-main: #ECEFF1;
            --text-glow: #00E5FF;
            
            --shadow-block: 4px 4px 0px rgba(0, 0, 0, 0.5);
            --shadow-glow: 0 0 20px rgba(0, 229, 255, 0.5);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'VT323', monospace;
            background: var(--bg-dark);
            color: var(--text-main);
            overflow-x: hidden;
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }
        
        /* Pixelated Background */
        .world-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: 
                linear-gradient(0deg, transparent 24%, rgba(120, 144, 156, .05) 25%, rgba(120, 144, 156, .05) 26%, transparent 27%, transparent 74%, rgba(120, 144, 156, .05) 75%, rgba(120, 144, 156, .05) 76%, transparent 77%, transparent),
                linear-gradient(90deg, transparent 24%, rgba(120, 144, 156, .05) 25%, rgba(120, 144, 156, .05) 26%, transparent 27%, transparent 74%, rgba(120, 144, 156, .05) 75%, rgba(120, 144, 156, .05) 76%, transparent 77%, transparent);
            background-size: 50px 50px;
            animation: worldShift 20s linear infinite;
        }
        
        @keyframes worldShift {
            0% { background-position: 0 0; }
            100% { background-position: 50px 50px; }
        }
        
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }
        
        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: var(--diamond);
            box-shadow: 0 0 10px var(--diamond);
            animation: float 15s infinite;
        }
        
        @keyframes float {
            0%, 100% { 
                transform: translateY(0) translateX(0);
                opacity: 0;
            }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% {
                transform: translateY(-100vh) translateX(100px);
                opacity: 0;
            }
        }
        
        /* Login Screen */
        .login-screen {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 2rem;
            position: relative;
        }
        
        .minecraft-logo {
            text-align: center;
            margin-bottom: 3rem;
            animation: logoFloat 3s ease-in-out infinite;
        }
        
        @keyframes logoFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .minecraft-logo h1 {
            font-family: 'Press Start 2P', cursive;
            font-size: clamp(1.5rem, 5vw, 3rem);
            color: var(--emerald);
            text-shadow: 
                4px 4px 0px var(--grass),
                0 0 30px var(--emerald);
            margin-bottom: 1rem;
            letter-spacing: 2px;
        }
        
        .minecraft-logo .subtitle {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
            color: var(--diamond);
            text-shadow: 2px 2px 0px var(--obsidian);
        }
        
        .login-container {
            background: var(--bg-medium);
            border: 4px solid var(--stone);
            padding: 2.5rem;
            max-width: 500px;
            width: 100%;
            box-shadow: 
                var(--shadow-block),
                inset 0 0 50px rgba(0, 229, 255, 0.1);
            position: relative;
        }
        
        .login-container::before {
            content: '';
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            background: linear-gradient(45deg, var(--diamond), var(--emerald), var(--gold), var(--redstone));
            z-index: -1;
            opacity: 0.3;
            filter: blur(10px);
        }

        .section-title {
            font-family: 'Press Start 2P', cursive;
            font-size: 0.9rem;
            color: var(--gold);
            margin-bottom: 1.5rem;
            text-align: center;
            text-shadow: 2px 2px 0px rgba(0, 0, 0, 0.5);
        }
        
        .pixel-btn {
            background: var(--grass);
            border: 4px solid var(--emerald);
            color: white;
            padding: 1rem 2rem;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.8rem;
            cursor: pointer;
            box-shadow: var(--shadow-block);
            transition: all 0.1s;
            text-transform: uppercase;
            position: relative;
            overflow: hidden;
            width: 100%;
        }
        
        .pixel-btn:hover {
            background: var(--emerald);
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0px rgba(0, 0, 0, 0.5);
        }
        
        .pixel-btn:active {
            transform: translate(4px, 4px);
            box-shadow: none;
        }

        .pixel-btn:disabled {
            background: var(--stone);
            border-color: var(--iron);
            cursor: not-allowed;
            opacity: 0.5;
        }
        
        .pixel-input {
            width: 100%;
            background: var(--bg-dark);
            border: 4px solid var(--stone);
            color: var(--text-main);
            padding: 1rem;
            font-family: 'VT323', monospace;
            font-size: 1.3rem;
            margin-bottom: 1.5rem;
            box-shadow: inset 2px 2px 0px rgba(0, 0, 0, 0.5);
        }
        
        .pixel-input:focus {
            outline: none;
            border-color: var(--diamond);
            box-shadow: inset 2px 2px 0px rgba(0, 0, 0, 0.5), 0 0 15px var(--diamond);
        }

        .character-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .character-option {
            background: var(--bg-dark);
            border: 3px solid var(--stone);
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .character-option:hover {
            border-color: var(--diamond);
            transform: translateY(-5px);
        }

        .character-option.selected {
            border-color: var(--emerald);
            background: rgba(0, 230, 118, 0.1);
            box-shadow: 0 0 20px rgba(0, 230, 118, 0.3);
        }

        .character-option.selected::after {
            content: '‚úì';
            position: absolute;
            top: 5px;
            right: 5px;
            color: var(--emerald);
            font-size: 1.5rem;
            font-family: 'Press Start 2P', cursive;
        }

        .character-icon {
            font-size: 3rem;
            margin-bottom: 0.5rem;
        }

        .character-name {
            font-family: 'VT323', monospace;
            font-size: 1.1rem;
            color: var(--text-main);
        }
        
        /* Game Screen */
        .game-screen {
            display: none;
            min-height: 100vh;
        }
        
        .game-screen.active {
            display: block;
        }
        
        .game-header {
            background: var(--bg-medium);
            border-bottom: 4px solid var(--stone);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
            box-shadow: 0 4px 0 rgba(0, 0, 0, 0.3);
        }
        
        .player-info {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            flex-wrap: wrap;
        }
        
        .player-avatar {
            font-size: 2.5rem;
            background: var(--bg-dark);
            padding: 0.5rem;
            border: 3px solid var(--emerald);
            box-shadow: var(--shadow-block);
        }
        
        .player-stats {
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
        }
        
        .player-name {
            font-family: 'Press Start 2P', cursive;
            font-size: 1rem;
            color: var(--emerald);
            text-shadow: 2px 2px 0px rgba(0, 0, 0, 0.5);
        }
        
        .level-badge {
            background: linear-gradient(135deg, var(--gold), var(--emerald));
            padding: 0.3rem 0.8rem;
            border: 2px solid var(--coal);
            font-family: 'Press Start 2P', cursive;
            font-size: 0.7rem;
            display: inline-block;
            box-shadow: 2px 2px 0px rgba(0, 0, 0, 0.5);
        }
        
        .xp-bar-container {
            background: var(--bg-dark);
            border: 2px solid var(--stone);
            height: 20px;
            width: 200px;
            position: relative;
            overflow: hidden;
        }
        
        .xp-bar {
            background: linear-gradient(90deg, var(--emerald), var(--diamond));
            height: 100%;
            transition: width 0.5s ease;
            box-shadow: inset 0 0 10px rgba(255, 255, 255, 0.3);
        }
        
        .xp-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: 'Press Start 2P', cursive;
            font-size: 0.6rem;
            color: white;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        }
        
        .resources {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .resource {
            background: var(--bg-dark);
            border: 3px solid var(--stone);
            padding: 0.5rem 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.8rem;
            box-shadow: 2px 2px 0px rgba(0, 0, 0, 0.3);
        }
        
        .resource-icon {
            font-size: 1.2rem;
        }

        .logout-btn {
            background: var(--redstone);
            border: 3px solid #8B0000;
            color: white;
            padding: 0.7rem 1.5rem;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.7rem;
            cursor: pointer;
            box-shadow: var(--shadow-block);
            transition: all 0.1s;
            text-transform: uppercase;
        }

        .logout-btn:hover {
            background: #FF1744;
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0px rgba(0, 0, 0, 0.5);
        }

        .logout-btn:active {
            transform: translate(4px, 4px);
            box-shadow: none;
        }
        
        .game-nav {
            background: var(--bg-medium);
            border-bottom: 4px solid var(--stone);
            padding: 0;
            display: flex;
            justify-content: center;
            gap: 0;
            overflow-x: auto;
        }
        
        .nav-tab {
            background: var(--bg-dark);
            border: none;
            border-right: 2px solid var(--stone);
            color: var(--text-main);
            padding: 1rem 2rem;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.7rem;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }
        
        .nav-tab:hover {
            background: var(--bg-light);
        }
        
        .nav-tab.active {
            background: var(--grass);
            color: white;
            box-shadow: inset 0 4px 0 var(--emerald);
        }
        
        .game-content {
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .world-section {
            display: none;
        }
        
        .world-section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .world-title {
            font-family: 'Press Start 2P', cursive;
            font-size: 1.5rem;
            color: var(--emerald);
            text-shadow: 3px 3px 0px rgba(0, 0, 0, 0.5);
            margin-bottom: 2rem;
            text-align: center;
        }
        
        .missions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .mission-card {
            background: var(--bg-medium);
            border: 4px solid var(--stone);
            padding: 1.5rem;
            box-shadow: var(--shadow-block);
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }
        
        .mission-card:hover {
            transform: translateY(-5px);
            box-shadow: 6px 6px 0px rgba(0, 0, 0, 0.5), 0 0 20px rgba(0, 229, 255, 0.2);
        }
        
        .mission-card.completed {
            border-color: var(--emerald);
            background: linear-gradient(135deg, var(--bg-medium), rgba(0, 230, 118, 0.1));
        }
        
        .mission-card.completed::before {
            content: '‚úì';
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 2rem;
            color: var(--emerald);
            font-family: 'Press Start 2P', cursive;
            text-shadow: 2px 2px 0px rgba(0, 0, 0, 0.5);
        }

        .mission-card.pending {
            border-color: var(--gold);
            background: linear-gradient(135deg, var(--bg-medium), rgba(255, 214, 0, 0.1));
        }

        .mission-card.pending::before {
            content: '‚è≥';
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 2rem;
        }
        
        .mission-difficulty {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.6rem;
            margin-bottom: 1rem;
            box-shadow: 2px 2px 0px rgba(0, 0, 0, 0.3);
        }
        
        .difficulty-facil {
            background: var(--grass);
            border: 2px solid var(--emerald);
            color: white;
        }
        
        .difficulty-medio {
            background: var(--gold);
            border: 2px solid #FFA000;
            color: var(--coal);
        }
        
        .difficulty-dificil {
            background: var(--redstone);
            border: 2px solid #8B0000;
            color: white;
        }
        
        .mission-title {
            font-family: 'Press Start 2P', cursive;
            font-size: 0.9rem;
            color: var(--diamond);
            margin-bottom: 1rem;
            line-height: 1.5;
        }
        
        .mission-desc {
            font-size: 1.1rem;
            color: var(--text-main);
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }
        
        .mission-rewards {
            display: flex;
            gap: 0.8rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        
        .reward {
            background: var(--bg-dark);
            border: 2px solid var(--stone);
            padding: 0.5rem 0.8rem;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .complete-btn {
            background: var(--grass);
            border: 3px solid var(--emerald);
            color: white;
            padding: 0.8rem 1.5rem;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.7rem;
            cursor: pointer;
            box-shadow: var(--shadow-block);
            transition: all 0.1s;
            width: 100%;
            text-transform: uppercase;
        }
        
        .complete-btn:hover {
            background: var(--emerald);
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0px rgba(0, 0, 0, 0.5);
        }
        
        .complete-btn:active {
            transform: translate(4px, 4px);
            box-shadow: none;
        }
        
        .complete-btn:disabled {
            background: var(--stone);
            border-color: var(--iron);
            cursor: not-allowed;
            opacity: 0.6;
        }
        
        /* Quests */
        .quests-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
        }
        
        .quest-card {
            background: var(--bg-medium);
            border: 4px solid var(--gold);
            padding: 1.5rem;
            box-shadow: var(--shadow-block), 0 0 20px rgba(255, 214, 0, 0.2);
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }
        
        .quest-card:hover {
            transform: translateY(-5px);
            box-shadow: 6px 6px 0px rgba(0, 0, 0, 0.5), 0 0 30px rgba(255, 214, 0, 0.3);
        }
        
        .quest-card.completed {
            border-color: var(--emerald);
            opacity: 0.7;
        }
        
        .quest-title {
            font-family: 'Press Start 2P', cursive;
            font-size: 0.9rem;
            color: var(--gold);
            margin-bottom: 1rem;
            line-height: 1.5;
        }
        
        .quest-desc {
            font-size: 1.1rem;
            color: var(--text-main);
            margin-bottom: 1rem;
            line-height: 1.6;
        }
        
        .quest-rewards {
            display: flex;
            gap: 0.8rem;
            flex-wrap: wrap;
        }
        
        .reward-item {
            background: var(--bg-dark);
            border: 2px solid var(--emerald);
            padding: 0.5rem 0.8rem;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        /* Recipes/Crafteo */
        .recipes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.5rem;
        }
        
        .recipe-card {
            background: var(--bg-medium);
            border: 4px solid var(--stone);
            padding: 1.5rem;
            text-align: center;
            box-shadow: var(--shadow-block);
            transition: all 0.2s;
        }
        
        .recipe-card:hover {
            transform: translateY(-5px);
            border-color: var(--diamond);
        }
        
        .recipe-item {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        .recipe-name {
            font-family: 'Press Start 2P', cursive;
            font-size: 0.8rem;
            color: var(--diamond);
            margin-bottom: 1rem;
        }
        
        .recipe-cost {
            font-family: 'VT323', monospace;
            font-size: 1.2rem;
            color: var(--gold);
            margin-bottom: 1rem;
        }
        
        .craft-btn {
            background: var(--lapis);
            border: 3px solid var(--diamond);
            color: white;
            padding: 0.8rem 1.5rem;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.7rem;
            cursor: pointer;
            box-shadow: var(--shadow-block);
            transition: all 0.1s;
            width: 100%;
            text-transform: uppercase;
        }
        
        .craft-btn:hover:not(:disabled) {
            background: var(--diamond);
            color: var(--coal);
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0px rgba(0, 0, 0, 0.5);
        }
        
        .craft-btn:disabled {
            background: var(--stone);
            border-color: var(--iron);
            cursor: not-allowed;
            opacity: 0.5;
        }
        
        /* Achievements */
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
        }
        
        .achievement-card {
            background: var(--bg-medium);
            border: 4px solid var(--stone);
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            box-shadow: var(--shadow-block);
            transition: all 0.2s;
        }
        
        .achievement-card.unlocked {
            border-color: var(--gold);
            background: linear-gradient(135deg, var(--bg-medium), rgba(255, 214, 0, 0.1));
            box-shadow: var(--shadow-block), 0 0 20px rgba(255, 214, 0, 0.3);
        }
        
        .achievement-card.locked {
            opacity: 0.4;
        }
        
        .achievement-icon {
            font-size: 2.5rem;
        }
        
        .achievement-name {
            font-family: 'Press Start 2P', cursive;
            font-size: 0.8rem;
            color: var(--gold);
            margin-bottom: 0.5rem;
        }
        
        .achievement-desc {
            font-size: 1rem;
            color: var(--text-main);
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 2rem;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: var(--bg-medium);
            border: 4px solid var(--gold);
            padding: 2rem;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 0 50px rgba(255, 214, 0, 0.5);
            position: relative;
        }
        
        .modal-header {
            font-family: 'Press Start 2P', cursive;
            font-size: 1.2rem;
            color: var(--gold);
            margin-bottom: 2rem;
            text-align: center;
            line-height: 1.5;
        }
        
        .close-modal {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: var(--redstone);
            border: 3px solid #8B0000;
            color: white;
            width: 40px;
            height: 40px;
            font-family: 'Press Start 2P', cursive;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 2px 2px 0px rgba(0, 0, 0, 0.5);
        }
        
        .close-modal:hover {
            background: #FF1744;
        }
        
        .complete-mission-btn {
            background: var(--grass);
            border: 4px solid var(--emerald);
            color: white;
            padding: 1rem 2rem;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.8rem;
            cursor: pointer;
            box-shadow: var(--shadow-block);
            transition: all 0.1s;
            width: 100%;
            text-transform: uppercase;
            margin-top: 1rem;
        }
        
        .complete-mission-btn:hover:not(:disabled) {
            background: var(--emerald);
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0px rgba(0, 0, 0, 0.5);
        }
        
        .complete-mission-btn:disabled {
            background: var(--stone);
            border-color: var(--iron);
            cursor: not-allowed;
            opacity: 0.6;
        }
        
        /* Notifications */
        .notification {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: var(--bg-medium);
            border: 4px solid var(--emerald);
            padding: 1.5rem;
            max-width: 350px;
            box-shadow: var(--shadow-block), 0 0 30px rgba(0, 230, 118, 0.5);
            z-index: 2000;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .notification-title {
            font-family: 'Press Start 2P', cursive;
            font-size: 0.8rem;
            color: var(--emerald);
            margin-bottom: 0.5rem;
        }
        
        .notification-message {
            font-size: 1.1rem;
            color: var(--text-main);
        }
        
        /* Active Quests Sidebar */
        .active-quests {
            background: var(--bg-medium);
            border: 3px solid var(--gold);
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-block);
        }
        
        .active-quests h3 {
            font-family: 'Press Start 2P', cursive;
            font-size: 0.9rem;
            color: var(--gold);
            margin-bottom: 1rem;
        }
        
        .active-quest-item {
            background: var(--bg-dark);
            border: 2px solid var(--stone);
            padding: 1rem;
            margin-bottom: 0.8rem;
        }
        
        .active-quest-item:last-child {
            margin-bottom: 0;
        }
        
        .active-quest-title {
            font-family: 'VT323', monospace;
            font-size: 1.1rem;
            color: var(--diamond);
            margin-bottom: 0.5rem;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .game-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .xp-bar-container {
                width: 100%;
            }
            
            .missions-grid, .quests-container, .recipes-grid, .achievements-grid {
                grid-template-columns: 1fr;
            }
            
            .character-selection {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="world-background"></div>
    <div class="particles" id="particles"></div>
    
    <!-- Login Screen -->
    <div class="login-screen" id="loginScreen">
        <div>
            <div class="minecraft-logo">
                <h1>CODECRAFT</h1>
                <div class="subtitle">Aventura Inform√°tica</div>
            </div>
            
            <div class="login-container">
                <h2 class="section-title">ELEG√ç TU PERSONAJE</h2>
                
                <div class="character-selection">
                    <div class="character-option" data-character="üë®‚Äçüíª">
                        <div class="character-icon">üë®‚Äçüíª</div>
                        <div class="character-name">Coder</div>
                    </div>
                    <div class="character-option" data-character="üßù‚Äç‚ôÇÔ∏è">
                        <div class="character-icon">üßù‚Äç‚ôÇÔ∏è</div>
                        <div class="character-name">Elfo</div>
                    </div>
                    <div class="character-option" data-character="üë©üèæ‚Äçüî¨">
                        <div class="character-icon">üë©üèæ‚Äçüî¨</div>
                        <div class="character-name">Cient√≠fica</div>
                    </div>
                    <div class="character-option" data-character="‚öîÔ∏è">
                        <div class="character-icon">‚öîÔ∏è</div>
                        <div class="character-name">Guerrero</div>
                    </div>
                    <div class="character-option" data-character="üßô‚Äç‚ôÄÔ∏è">
                        <div class="character-icon">üßô‚Äç‚ôÄÔ∏è</div>
                        <div class="character-name">Hechicera</div>
                    </div>
                    <div class="character-option" data-character="ü§ñ">
                        <div class="character-icon">ü§ñ</div>
                        <div class="character-name">Robot</div>
                    </div>
                </div>
                
                <input 
                    type="text" 
                    id="playerName" 
                    class="pixel-input" 
                    placeholder="Ingres√° tu nombre..."
                    maxlength="20"
                >
                
                <button class="pixel-btn" onclick="startGame()">
                    ENTRAR AL MUNDO
                </button>
            </div>
        </div>
    </div>
    
    <!-- Game Screen -->
    <div class="game-screen" id="gameScreen">
        <!-- Header -->
        <div class="game-header">
            <div class="player-info">
                <div class="player-avatar" id="playerAvatar">üßë‚Äçüíª</div>
                <div class="player-stats">
                    <div class="player-name" id="playerNameDisplay">Jugador</div>
                    <div class="level-badge">NIVEL <span id="playerLevel">1</span></div>
                    <div class="xp-bar-container">
                        <div class="xp-bar" id="xpBar" style="width: 0%"></div>
                        <div class="xp-text" id="xpText">0 / 100 XP</div>
                    </div>
                </div>
            </div>
            
            <div class="resources">
                <div class="resource">
                    <span class="resource-icon">üíé</span>
                    <span id="diamondsCount">0</span>
                </div>
                <div class="resource">
                    <span class="resource-icon">üíö</span>
                    <span id="emeraldsCount">0</span>
                </div>
                <div class="resource">
                    <span class="resource-icon">ü™ô</span>
                    <span id="goldCount">0</span>
                </div>
            </div>

            <button class="logout-btn" onclick="logout()">
                SALIR
            </button>
        </div>
        
        <!-- Navigation -->
        <div class="game-nav">
            <button class="nav-tab active" data-world="missions">üìö MISIONES</button>
            <button class="nav-tab" data-world="quests">‚öîÔ∏è DESAF√çOS</button>
            <button class="nav-tab" data-world="crafting">üî® CRAFTEO</button>
            <button class="nav-tab" data-world="achievements">üèÜ LOGROS</button>
        </div>
        
        <!-- Game Content -->
        <div class="game-content">
            <!-- Missions World -->
            <div class="world-section active" id="missions">
                <h2 class="world-title">üåç MUNDO DE MISIONES</h2>
                
                <div class="active-quests" id="activeQuestsContainer" style="display: none;">
                    <h3>‚ö° DESAF√çOS ACTIVOS</h3>
                    <div id="activeQuestsList"></div>
                </div>
                
                <div class="missions-grid" id="missionsContainer"></div>
            </div>
            
            <!-- Quests World -->
            <div class="world-section" id="quests">
                <h2 class="world-title">‚öîÔ∏è DESAF√çOS ESPECIALES</h2>
                <div class="quests-container" id="questsContainer"></div>
            </div>
            
            <!-- Crafting World -->
            <div class="world-section" id="crafting">
                <h2 class="world-title">üî® MESA DE CRAFTEO</h2>
                <div class="recipes-grid" id="recipesContainer"></div>
            </div>
            
            <!-- Achievements World -->
            <div class="world-section" id="achievements">
                <h2 class="world-title">üèÜ SALA DE TROFEOS</h2>
                <div class="achievements-grid" id="achievementsContainer"></div>
            </div>
        </div>
    </div>
    
    <!-- Quest Modal -->
    <div class="modal" id="questModal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal()">‚úï</button>
            <h2 class="modal-header" id="modalTitle"></h2>
            <div id="modalBody"></div>
        </div>
    </div>
    
    <script>
        // Game Data
        const missionsData = [
            {
                id: 'hardware1',
                title: 'Explorando el Hardware',
                difficulty: 'facil',
                desc: 'Identifica las partes principales de una computadora: CPU, RAM, disco duro y placa madre.',
                xp: 50,
                rewards: { diamonds: 5 }
            },
            {
                id: 'software1',
                title: 'Software y Aplicaciones',
                difficulty: 'facil',
                desc: 'Diferencia entre software de sistema y software de aplicaci√≥n. Da 3 ejemplos de cada uno.',
                xp: 50,
                rewards: { emeralds: 3 }
            },
            {
                id: 'binary1',
                title: 'El Lenguaje Binario',
                difficulty: 'medio',
                desc: 'Convierte los n√∫meros 10, 25 y 50 a sistema binario. Explica c√≥mo funciona.',
                xp: 100,
                rewards: { diamonds: 10, emeralds: 5 }
            },
            {
                id: 'algorithms1',
                title: 'Primeros Algoritmos',
                difficulty: 'medio',
                desc: 'Crea un algoritmo para preparar un mate usando pseudoc√≥digo.',
                xp: 100,
                rewards: { gold: 10 }
            },
            {
                id: 'internet1',
                title: 'C√≥mo Funciona Internet',
                difficulty: 'medio',
                desc: 'Investiga qu√© es una direcci√≥n IP, un servidor y un DNS. Explica con tus palabras.',
                xp: 150,
                rewards: { diamonds: 15, gold: 5 }
            },
            {
                id: 'digital1',
                title: 'Huella Digital',
                difficulty: 'facil',
                desc: 'Investiga qu√© es la huella digital. ¬øQu√© informaci√≥n tuya est√° en internet?',
                xp: 80,
                rewards: { emeralds: 8, gold: 5 }
            },
            {
                id: 'digital2',
                title: 'Contrase√±as Seguras',
                difficulty: 'facil',
                desc: 'Crea 3 ejemplos de contrase√±as: una MALA, una REGULAR y una SEGURA.',
                xp: 70,
                rewards: { diamonds: 7 }
            },
            {
                id: 'digital3',
                title: 'Privacidad en Redes',
                difficulty: 'medio',
                desc: 'Analiza la configuraci√≥n de privacidad de una red social. ¬øQu√© deber√≠as hacer privado?',
                xp: 120,
                rewards: { diamonds: 12, emeralds: 8 }
            },
            {
                id: 'digital4',
                title: 'Phishing y Estafas',
                difficulty: 'medio',
                desc: 'Investiga qu√© es el phishing. Crea un afiche digital alertando sobre este peligro.',
                xp: 130,
                rewards: { diamonds: 13, gold: 10 }
            },
            {
                id: 'digital5',
                title: 'Ciberbullying',
                difficulty: 'medio',
                desc: '¬øQu√© es el ciberbullying? ¬øQu√© har√≠as si vos o un amigo lo sufre?',
                xp: 140,
                rewards: { emeralds: 15, gold: 12 }
            },
            {
                id: 'digital6',
                title: 'Fake News',
                difficulty: 'dificil',
                desc: 'Investiga 3 formas de identificar noticias falsas. Analiza un caso real.',
                xp: 180,
                rewards: { diamonds: 18, emeralds: 12, gold: 10 }
            },
            {
                id: 'programming1',
                title: 'Introducci√≥n a la Programaci√≥n',
                difficulty: 'dificil',
                desc: 'Crea un programa en Scratch que dibuje un cuadrado usando bucles.',
                xp: 200,
                rewards: { diamonds: 20, emeralds: 10, gold: 10 }
            }
        ];
        
        const questsData = [
            {
                id: 'quest1',
                title: 'El Desaf√≠o del Creeper',
                difficulty: 'medio',
                desc: 'Crea un juego en Scratch donde un personaje debe esquivar enemigos que caen del cielo.',
                xp: 300,
                rewards: { diamonds: 30, emeralds: 15 }
            },
            {
                id: 'quest2',
                title: 'Arquitectura de la PC',
                difficulty: 'dificil',
                desc: 'Investiga la arquitectura Von Neumann y crea una presentaci√≥n explic√°ndola.',
                xp: 400,
                rewards: { diamonds: 40, gold: 20 }
            },
            {
                id: 'quest3',
                title: 'Red Social del Futuro',
                difficulty: 'dificil',
                desc: 'Dise√±a en papel o digitalmente c√≥mo ser√≠a tu red social ideal. Incluye funciones innovadoras.',
                xp: 350,
                rewards: { emeralds: 25, gold: 15 }
            }
        ];
        
        const recipesData = [
            {
                id: 'recipe1',
                icon: 'üó°Ô∏è',
                name: 'Espada de Conocimiento',
                cost: { diamonds: 10 },
                effect: 'Multiplica XP x1.5'
            },
            {
                id: 'recipe2',
                icon: 'üõ°Ô∏è',
                name: 'Escudo Protector',
                cost: { emeralds: 15 },
                effect: 'Protecci√≥n extra'
            },
            {
                id: 'recipe3',
                icon: '‚ö°',
                name: 'Botas de Velocidad',
                cost: { gold: 20 },
                effect: 'Completa misiones m√°s r√°pido'
            },
            {
                id: 'recipe4',
                icon: 'üëë',
                name: 'Corona del Maestro',
                cost: { diamonds: 50, emeralds: 30, gold: 40 },
                effect: 'Bonificaci√≥n total'
            }
        ];
        
        const achievementsData = [
            { id: 'ach1', icon: 'üåü', name: 'Primera Misi√≥n', desc: 'Completa tu primera misi√≥n' },
            { id: 'ach2', icon: 'üíé', name: 'Coleccionista', desc: 'Consigue 50 diamantes' },
            { id: 'ach3', icon: 'üìö', name: 'Estudiante Dedicado', desc: 'Completa 5 misiones' },
            { id: 'ach4', icon: 'üî®', name: 'Craftero Experto', desc: 'Craftea 3 items' },
            { id: 'ach5', icon: '‚öîÔ∏è', name: 'Guerrero', desc: 'Completa un desaf√≠o dif√≠cil' },
            { id: 'ach6', icon: 'üèÜ', name: 'Maestro CodeCraft', desc: 'Alcanza nivel 10' }
        ];
        
        // Game State Management
        class GameState {
            constructor() {
                this.loadState();
            }
            
            loadState() {
                const saved = localStorage.getItem('codecraft_players');
                this.players = saved ? JSON.parse(saved) : {};
                this.currentPlayer = localStorage.getItem('codecraft_current_player');
                
                if (this.currentPlayer && this.players[this.currentPlayer]) {
                    this.player = this.players[this.currentPlayer];
                } else {
                    this.player = null;
                }
            }
            
            saveState() {
                if (this.player) {
                    this.players[this.player.name] = this.player;
                    localStorage.setItem('codecraft_players', JSON.stringify(this.players));
                    localStorage.setItem('codecraft_current_player', this.player.name);
                }
            }
            
            createPlayer(name, character) {
                // Si el jugador ya existe, cargar su progreso
                if (this.players[name]) {
                    this.player = this.players[name];
                    this.currentPlayer = name;
                } else {
                    // Crear nuevo jugador
                    this.player = {
                        name: name,
                        character: character,
                        level: 1,
                        xp: 0,
                        xpToNextLevel: 100,
                        diamonds: 0,
                        emeralds: 0,
                        gold: 0,
                        completedMissions: [],
                        pendingMissions: [],
                        completedQuests: [],
                        craftedItems: [],
                        achievements: []
                    };
                    this.currentPlayer = name;
                }
                this.saveState();
            }
            
            logout() {
                this.player = null;
                this.currentPlayer = null;
                localStorage.removeItem('codecraft_current_player');
            }
            
            addXP(amount) {
                this.player.xp += amount;
                
                while (this.player.xp >= this.player.xpToNextLevel) {
                    this.player.xp -= this.player.xpToNextLevel;
                    this.player.level++;
                    this.player.xpToNextLevel = Math.floor(this.player.xpToNextLevel * 1.5);
                    
                    showNotification('¬°NIVEL SUBIDO!', `Ahora eres nivel ${this.player.level}`, 'success');
                }
                
                this.checkAchievements();
                this.saveState();
                updateUI();
            }
            
            addResources(resources) {
                if (resources.diamonds) this.player.diamonds += resources.diamonds;
                if (resources.emeralds) this.player.emeralds += resources.emeralds;
                if (resources.gold) this.player.gold += resources.gold;
                this.saveState();
                updateUI();
            }
            
            markMissionPending(missionId) {
                if (!this.player.pendingMissions.includes(missionId) && 
                    !this.player.completedMissions.includes(missionId)) {
                    this.player.pendingMissions.push(missionId);
                    this.saveState();
                    return true;
                }
                return false;
            }

            approveMission(missionId, code) {
                // Validar c√≥digo: 3 letras + 1 n√∫mero
                const pattern = /^[A-Za-z]{3}[0-9]$/;
                if (!pattern.test(code)) {
                    showNotification('C√ìDIGO INCORRECTO', 'Debe tener 3 letras y 1 n√∫mero (ej: ABC1)', 'error');
                    return false;
                }

                const mission = missionsData.find(m => m.id === missionId);
                if (!mission) return false;

                this.player.pendingMissions = this.player.pendingMissions.filter(id => id !== missionId);
                this.player.completedMissions.push(missionId);
                
                this.addXP(mission.xp);
                this.addResources(mission.rewards);
                
                showNotification('¬°MISI√ìN APROBADA!', `+${mission.xp} XP`, 'success');
                
                this.checkAchievements();
                this.saveState();
                return true;
            }
            
            completeMission(missionId) {
                if (this.player.completedMissions.includes(missionId)) return false;
                
                const mission = missionsData.find(m => m.id === missionId);
                if (!mission) return false;
                
                this.player.completedMissions.push(missionId);
                this.addXP(mission.xp);
                this.addResources(mission.rewards);
                
                showNotification('¬°MISI√ìN COMPLETADA!', `+${mission.xp} XP`, 'success');
                
                this.checkAchievements();
                this.saveState();
                return true;
            }
            
            completeQuest(questId) {
                if (this.player.completedQuests.includes(questId)) return false;
                
                const quest = questsData.find(q => q.id === questId);
                if (!quest) return false;
                
                this.player.completedQuests.push(questId);
                this.addXP(quest.xp);
                this.addResources(quest.rewards);
                
                showNotification('¬°DESAF√çO COMPLETADO!', `+${quest.xp} XP`, 'success');
                
                this.checkAchievements();
                this.saveState();
                return true;
            }
            
            craftItem(itemId) {
                if (this.player.craftedItems.includes(itemId)) return false;
                
                const recipe = recipesData.find(r => r.id === itemId);
                if (!recipe) return false;
                
                // Check if player has enough resources
                if (recipe.cost.diamonds && this.player.diamonds < recipe.cost.diamonds) return false;
                if (recipe.cost.emeralds && this.player.emeralds < recipe.cost.emeralds) return false;
                if (recipe.cost.gold && this.player.gold < recipe.cost.gold) return false;
                
                // Deduct resources
                if (recipe.cost.diamonds) this.player.diamonds -= recipe.cost.diamonds;
                if (recipe.cost.emeralds) this.player.emeralds -= recipe.cost.emeralds;
                if (recipe.cost.gold) this.player.gold -= recipe.cost.gold;
                
                this.player.craftedItems.push(itemId);
                
                showNotification('¬°ITEM CRAFTEADO!', recipe.name, 'success');
                
                this.checkAchievements();
                this.saveState();
                updateUI();
                return true;
            }
            
            checkAchievements() {
                const newAchievements = [];
                
                // Primera misi√≥n
                if (this.player.completedMissions.length >= 1 && !this.player.achievements.includes('ach1')) {
                    this.player.achievements.push('ach1');
                    newAchievements.push('Primera Misi√≥n');
                }
                
                // Coleccionista
                if (this.player.diamonds >= 50 && !this.player.achievements.includes('ach2')) {
                    this.player.achievements.push('ach2');
                    newAchievements.push('Coleccionista');
                }
                
                // Estudiante Dedicado
                if (this.player.completedMissions.length >= 5 && !this.player.achievements.includes('ach3')) {
                    this.player.achievements.push('ach3');
                    newAchievements.push('Estudiante Dedicado');
                }
                
                // Craftero Experto
                if (this.player.craftedItems.length >= 3 && !this.player.achievements.includes('ach4')) {
                    this.player.achievements.push('ach4');
                    newAchievements.push('Craftero Experto');
                }
                
                // Guerrero
                if (this.player.completedQuests.length >= 1 && !this.player.achievements.includes('ach5')) {
                    this.player.achievements.push('ach5');
                    newAchievements.push('Guerrero');
                }
                
                // Maestro CodeCraft
                if (this.player.level >= 10 && !this.player.achievements.includes('ach6')) {
                    this.player.achievements.push('ach6');
                    newAchievements.push('Maestro CodeCraft');
                }
                
                newAchievements.forEach(ach => {
                    showNotification('üèÜ LOGRO DESBLOQUEADO', ach, 'achievement');
                });
                
                this.saveState();
            }
        }
        
        const gameState = new GameState();
        
        // Particle Effects
        function createParticles() {
            const container = document.getElementById('particles');
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 15 + 's';
                particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
                container.appendChild(particle);
            }
        }
        
        // Game Functions
        function startGame() {
            const nameInput = document.getElementById('playerName');
            const name = nameInput.value.trim();
            
            if (!name) {
                alert('Por favor ingres√° tu nombre');
                return;
            }
            
            const selectedCharacter = document.querySelector('.character-option.selected');
            if (!selectedCharacter) {
                alert('Por favor eleg√≠ un personaje');
                return;
            }
            
            const character = selectedCharacter.dataset.character;
            
            gameState.createPlayer(name, character);
            initializeGame();
        }
        
        function initializeGame() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('gameScreen').classList.add('active');
            
            updateUI();
            loadMissions();
            loadQuests();
            loadRecipes();
            loadAchievements();
            loadActiveQuests();
        }
        
        function updateUI() {
            if (!gameState.player) return;
            
            document.getElementById('playerNameDisplay').textContent = gameState.player.name;
            document.getElementById('playerAvatar').textContent = gameState.player.character;
            document.getElementById('playerLevel').textContent = gameState.player.level;
            
            const xpPercent = (gameState.player.xp / gameState.player.xpToNextLevel) * 100;
            document.getElementById('xpBar').style.width = xpPercent + '%';
            document.getElementById('xpText').textContent = `${gameState.player.xp} / ${gameState.player.xpToNextLevel} XP`;
            
            document.getElementById('diamondsCount').textContent = gameState.player.diamonds;
            document.getElementById('emeraldsCount').textContent = gameState.player.emeralds;
            document.getElementById('goldCount').textContent = gameState.player.gold;
        }
        
        function loadMissions() {
            const container = document.getElementById('missionsContainer');
            container.innerHTML = missionsData.map(mission => {
                const isCompleted = gameState.player.completedMissions.includes(mission.id);
                const isPending = gameState.player.pendingMissions.includes(mission.id);
                
                return `
                    <div class="mission-card ${isCompleted ? 'completed' : ''} ${isPending ? 'pending' : ''}">
                        <div class="mission-difficulty difficulty-${mission.difficulty}">
                            ${mission.difficulty.toUpperCase()}
                        </div>
                        <div class="mission-title">${mission.title}</div>
                        <div class="mission-desc">${mission.desc}</div>
                        <div class="mission-rewards">
                            <div class="reward">‚ö° +${mission.xp} XP</div>
                            ${mission.rewards.diamonds ? `<div class="reward">üíé +${mission.rewards.diamonds}</div>` : ''}
                            ${mission.rewards.emeralds ? `<div class="reward">üíö +${mission.rewards.emeralds}</div>` : ''}
                            ${mission.rewards.gold ? `<div class="reward">ü™ô +${mission.rewards.gold}</div>` : ''}
                        </div>
                        ${isPending ? `
                            <div style="background: rgba(156, 39, 176, 0.2); padding: 0.8rem; margin: 1rem 0; text-align: center; border: 2px solid #9C27B0;">
                                üë©‚Äçüè´ Esperando aprobaci√≥n de la profe
                            </div>
                            <button class="complete-btn" style="background: #FFD600; border-color: #FFA000; color: #000;" onclick="showApprovalModal('${mission.id}')">
                                INGRESAR C√ìDIGO
                            </button>
                        ` : isCompleted ? `
                            <button class="complete-btn" disabled>
                                ‚úì COMPLETADA
                            </button>
                        ` : `
                            <button class="complete-btn" onclick="markMissionPending('${mission.id}')">
                                TERMIN√â LA MISI√ìN
                            </button>
                        `}
                    </div>
                `;
            }).join('');
        }
        
        function loadQuests() {
            const container = document.getElementById('questsContainer');
            container.innerHTML = questsData.map(quest => {
                const isCompleted = gameState.player.completedQuests.includes(quest.id);
                
                return `
                    <div class="quest-card ${isCompleted ? 'completed' : ''}" onclick="showQuestModal('${quest.id}')">
                        <div class="mission-difficulty difficulty-${quest.difficulty}">
                            ${quest.difficulty.toUpperCase()}
                        </div>
                        <div class="quest-title">${quest.title}</div>
                        <div class="quest-desc">${quest.desc}</div>
                        <div class="quest-rewards">
                            <div class="reward-item">
                                <span class="reward-icon">‚ö°</span>
                                <span>+${quest.xp} XP</span>
                            </div>
                            ${quest.rewards.diamonds ? `
                                <div class="reward-item">
                                    <span class="reward-icon">üíé</span>
                                    <span>+${quest.rewards.diamonds}</span>
                                </div>
                            ` : ''}
                            ${quest.rewards.emeralds ? `
                                <div class="reward-item">
                                    <span class="reward-icon">üíö</span>
                                    <span>+${quest.rewards.emeralds}</span>
                                </div>
                            ` : ''}
                            ${quest.rewards.gold ? `
                                <div class="reward-item">
                                    <span class="reward-icon">ü™ô</span>
                                    <span>+${quest.rewards.gold}</span>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function loadActiveQuests() {
            const activeQuests = questsData.filter(q => !gameState.player.completedQuests.includes(q.id));
            const container = document.getElementById('activeQuestsContainer');
            const list = document.getElementById('activeQuestsList');
            
            if (activeQuests.length === 0) {
                container.style.display = 'none';
                return;
            }
            
            container.style.display = 'block';
            list.innerHTML = activeQuests.map(quest => {
                return `
                    <div class="active-quest-item">
                        <div class="active-quest-title">${quest.title}</div>
                        <div class="quest-rewards">
                            <div class="reward-item">
                                <span class="reward-icon">‚ö°</span>
                                <span>+${quest.xp} XP</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function loadRecipes() {
            const container = document.getElementById('recipesContainer');
            container.innerHTML = recipesData.map(recipe => {
                const canCraft = 
                    (!recipe.cost.diamonds || gameState.player.diamonds >= recipe.cost.diamonds) &&
                    (!recipe.cost.emeralds || gameState.player.emeralds >= recipe.cost.emeralds) &&
                    (!recipe.cost.gold || gameState.player.gold >= recipe.cost.gold);
                
                const isCrafted = gameState.player.craftedItems.includes(recipe.id);
                
                return `
                    <div class="recipe-card">
                        <div class="recipe-item">${recipe.icon}</div>
                        <div class="recipe-name">${recipe.name}</div>
                        <div class="recipe-cost">
                            ${recipe.cost.diamonds ? `üíé ${recipe.cost.diamonds} ` : ''}
                            ${recipe.cost.emeralds ? `üíö ${recipe.cost.emeralds} ` : ''}
                            ${recipe.cost.gold ? `ü™ô ${recipe.cost.gold}` : ''}
                        </div>
                        <div style="font-size: 0.9rem; color: var(--text-main); margin-top: 0.5rem;">${recipe.effect}</div>
                        <button class="craft-btn" onclick="craftItem('${recipe.id}')" ${!canCraft || isCrafted ? 'disabled' : ''}>
                            ${isCrafted ? '‚úì CRAFTEADO' : 'CRAFTEAR'}
                        </button>
                    </div>
                `;
            }).join('');
        }
        
        function loadAchievements() {
            const container = document.getElementById('achievementsContainer');
            container.innerHTML = achievementsData.map(achievement => {
                const isUnlocked = gameState.player.achievements.includes(achievement.id);
                
                return `
                    <div class="achievement-card ${isUnlocked ? 'unlocked' : 'locked'}">
                        <span class="achievement-icon">${achievement.icon}</span>
                        <div>
                            <div class="achievement-name">${achievement.name}</div>
                            <div class="achievement-desc">${achievement.desc}</div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function completeMission(missionId) {
            if (gameState.completeMission(missionId)) {
                loadMissions();
                loadActiveQuests();
                loadAchievements();
            }
        }
        
        function showQuestModal(questId) {
            const quest = questsData.find(q => q.id === questId);
            if (!quest) return;
            
            const isCompleted = gameState.player.completedQuests.includes(questId);
            
            const modal = document.getElementById('questModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalBody = document.getElementById('modalBody');
            
            modalTitle.textContent = quest.title;
            
            modalBody.innerHTML = `
                <div style="background: rgba(247, 184, 1, 0.1); padding: 1.5rem; border: 3px solid var(--gold); margin-bottom: 2rem;">
                    <div style="font-family: 'Press Start 2P', cursive; font-size: 0.9rem; color: var(--gold); margin-bottom: 1rem;">
                        DIFICULTAD: ${quest.difficulty.toUpperCase()}
                    </div>
                    <div style="font-size: 1.2rem; margin-bottom: 1rem;">
                        ${quest.description}
                    </div>
                    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                        <div style="background: var(--bg-dark); padding: 0.8rem 1.2rem; border: 2px solid var(--emerald);">
                            ‚ö° +${quest.xp} XP
                        </div>
                        ${quest.rewards.diamonds ? `
                            <div style="background: var(--bg-dark); padding: 0.8rem 1.2rem; border: 2px solid var(--diamond);">
                                üíé +${quest.rewards.diamonds}
                            </div>
                        ` : ''}
                        ${quest.rewards.emeralds ? `
                            <div style="background: var(--bg-dark); padding: 0.8rem 1.2rem; border: 2px solid var(--emerald);">
                                üíö +${quest.rewards.emeralds}
                            </div>
                        ` : ''}
                        ${quest.rewards.gold ? `
                            <div style="background: var(--bg-dark); padding: 0.8rem 1.2rem; border: 2px solid var(--gold);">
                                ü™ô +${quest.rewards.gold}
                            </div>
                        ` : ''}
                    </div>
                </div>
                
                <div style="background: var(--bg-dark); padding: 1.5rem; border: 3px solid var(--stone); margin-bottom: 2rem;">
                    <h3 style="font-family: 'Press Start 2P', cursive; color: var(--diamond); font-size: 0.9rem; margin-bottom: 1rem;">
                        üìã INSTRUCCIONES
                    </h3>
                    <p style="font-size: 1.1rem; line-height: 1.6;">
                        ${quest.desc}
                    </p>
                    <p style="font-size: 1rem; margin-top: 1rem; color: var(--text-main); opacity: 0.8;">
                        Cuando termines, presiona el bot√≥n para marcar el desaf√≠o como completado.
                    </p>
                </div>
                
                <button class="complete-mission-btn" onclick="completeQuest('${questId}')" ${isCompleted ? 'disabled' : ''}>
                    ${isCompleted ? '‚úì DESAF√çO COMPLETADO' : 'COMPLETAR DESAF√çO'}
                </button>
            `;
            
            modal.classList.add('active');
        }
        
        function completeQuest(questId) {
            if (gameState.completeQuest(questId)) {
                closeModal();
                loadQuests();
                loadActiveQuests();
                loadAchievements();
            }
        }
        
        function craftItem(itemId) {
            if (gameState.craftItem(itemId)) {
                loadRecipes();
                loadAchievements();
            } else {
                showNotification('NO TIENES SUFICIENTES RECURSOS', 'Necesitas m√°s materiales', 'info');
            }
        }
        
        function closeModal() {
            document.getElementById('questModal').classList.remove('active');
        }
        
        function showNotification(title, message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div class="notification-title">${title}</div>
                <div class="notification-message">${message}</div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
        
        function markMissionPending(missionId) {
            if (gameState.markMissionPending(missionId)) {
                showNotification('MISI√ìN MARCADA', 'Esper√° la aprobaci√≥n de tu profe', 'info');
                loadMissions();
            }
        }

        function showApprovalModal(missionId) {
            const modal = document.createElement('div');
            modal.id = 'approvalModal';
            modal.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: flex; justify-content: center; align-items: center; z-index: 1000; padding: 2rem;';
            
            modal.innerHTML = `
                <div style="background: var(--bg-medium); border: 4px solid var(--gold); padding: 2rem; max-width: 500px; width: 100%; position: relative;">
                    <button onclick="closeApprovalModal()" style="position: absolute; top: 1rem; right: 1rem; background: var(--redstone); border: 3px solid #8B0000; color: white; width: 40px; height: 40px; font-family: 'Press Start 2P'; cursor: pointer;">‚úï</button>
                    
                    <h2 style="font-family: 'Press Start 2P'; font-size: 1rem; color: var(--gold); margin-bottom: 2rem; text-align: center;">APROBACI√ìN DE MISI√ìN</h2>
                    
                    <div style="background: var(--bg-dark); padding: 1.5rem; border: 3px solid #9C27B0; margin-bottom: 2rem;">
                        <p style="font-size: 1.1rem; line-height: 1.6; margin-bottom: 1rem;">
                            üë©‚Äçüè´ Tu profe debe revisar tu trabajo.<br>
                            Si est√° correcto, te dar√° el c√≥digo de aprobaci√≥n.
                        </p>
                        <p style="font-size: 1rem; color: var(--gold);">
                            El c√≥digo tiene 3 letras y 1 n√∫mero<br>
                            Ejemplo: ABC1 o XYZ5
                        </p>
                    </div>
                    
                    <input 
                        type="text" 
                        id="approvalCodeInput" 
                        placeholder="Ejemplo: ABC1"
                        maxlength="4"
                        style="width: 100%; background: var(--bg-dark); border: 4px solid var(--stone); color: var(--text-main); padding: 1rem; font-family: 'VT323'; font-size: 1.3rem; margin-bottom: 1.5rem; text-transform: uppercase;"
                    >
                    
                    <button onclick="submitApproval('${missionId}')" style="background: var(--grass); border: 4px solid var(--emerald); color: white; padding: 1rem 2rem; font-family: 'Press Start 2P'; font-size: 0.8rem; cursor: pointer; width: 100%;">
                        APROBAR MISI√ìN
                    </button>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            modal.addEventListener('click', (e) => {
                if (e.target.id === 'approvalModal') {
                    closeApprovalModal();
                }
            });
        }

        function closeApprovalModal() {
            const modal = document.getElementById('approvalModal');
            if (modal) {
                modal.remove();
            }
        }

        function submitApproval(missionId) {
            const code = document.getElementById('approvalCodeInput').value;
            
            if (gameState.approveMission(missionId, code)) {
                closeApprovalModal();
                loadMissions();
                loadAchievements();
            }
        }
        
        function logout() {
            if (confirm('¬øSeguro que quer√©s salir? Tu progreso est√° guardado.')) {
                gameState.logout();
                location.reload();
            }
        }
        
        // Navigation
        document.addEventListener('DOMContentLoaded', () => {
            createParticles();
            
            // Character selection
            document.querySelectorAll('.character-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.character-option').forEach(o => o.classList.remove('selected'));
                    this.classList.add('selected');
                });
            });
            
            // Nav tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const world = this.dataset.world;
                    
                    document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    document.querySelectorAll('.world-section').forEach(s => s.classList.remove('active'));
                    document.getElementById(world).classList.add('active');
                });
            });
            
            // Auto-login if player exists
            if (gameState.player) {
                initializeGame();
            }
        });
        
        // Close modal on outside click
        document.getElementById('questModal').addEventListener('click', (e) => {
            if (e.target.id === 'questModal') {
                closeModal();
            }
        });
        
        // Enter key to start game
        document.getElementById('playerName').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                startGame();
            }
        });
    </script>
</body>
</html>
